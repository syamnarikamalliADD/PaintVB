{\rtf1\adeflang1025\ansi\ansicpg1252\uc1\adeff0\deff0\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman{\*\falt Times New Roman};}{\f37\froman\fcharset238\fprq2 Times New Roman CE{\*\falt Times New Roman};}
{\f38\froman\fcharset204\fprq2 Times New Roman Cyr{\*\falt Times New Roman};}{\f40\froman\fcharset161\fprq2 Times New Roman Greek{\*\falt Times New Roman};}{\f41\froman\fcharset162\fprq2 Times New Roman Tur{\*\falt Times New Roman};}
{\f42\fbidi \froman\fcharset177\fprq2 Times New Roman (Hebrew){\*\falt Times New Roman};}{\f43\fbidi \froman\fcharset178\fprq2 Times New Roman (Arabic){\*\falt Times New Roman};}
{\f44\froman\fcharset186\fprq2 Times New Roman Baltic{\*\falt Times New Roman};}{\f45\froman\fcharset163\fprq2 Times New Roman (Vietnamese){\*\falt Times New Roman};}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;
\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;
\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\ql \li0\ri0\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 
\snext0 Normal;}{\*\cs10 \additive \ssemihidden Default Paragraph Font;}{\*
\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\trcbpat1\trcfpat1\tblind0\tblindtype3\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv 
\ql \li0\ri0\widctlpar\wrapdefault\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs20 \ltrch\fcs0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 \ssemihidden Normal Table;}}
{\*\latentstyles\lsdstimax156\lsdlockeddef0}{\*\rsidtbl \rsid6835532\rsid8463552\rsid10304090\rsid13729148\rsid15933731\rsid16659031}{\*\generator Microsoft Word 11.0.0000;}{\info{\operator whitems}{\creatim\yr2014\mo1\dy15\hr10\min49}
{\revtim\yr2014\mo2\dy17\hr10\min1}{\version4}{\edmins37}{\nofpages4}{\nofwords1620}{\nofchars9235}{\nofcharsws10834}{\vern24617}{\*\password 00000000}}{\*\xmlnstbl {\xmlns1 http://schemas.microsoft.com/office/word/2003/wordml}{\xmlns2 urn:schemas-microso
ft-com:office:smarttags}}\paperw12240\paperh15840\margl1800\margr1800\margt1440\margb1440\gutter0\ltrsect 
\widowctrl\ftnbj\aenddoc\donotembedsysfont0\donotembedlingdata1\grfdocevents0\validatexml0\showplaceholdtext0\ignoremixedcontent0\saveinvalidxml0\showxmlerrors0\horzdoc\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3
\jcompress\viewkind4\viewscale100\rsidroot10304090 \fet0{\*\wgrffmtfilter 013f}\ilfomacatclnup0\ltrpar \sectd \ltrsect\linex0\sectdefaultcl\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl2
\pnucltr\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang {\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang {\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl6
\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang {\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang 
{\pntxtb (}{\pntxta )}}\pard\plain \ltrpar\ql \li0\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin0\itap0 \rtlch\fcs1 \af0\afs24\alang1025 \ltrch\fcs0 \fs24\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 
Notes on paintworks setup and debug.
\par 
\par Start with the paintworks PC installation procedure from a recent project, use it, make any notes of differences you need for any new versions of support programs \endash  PLC communication, sql server, etc.  It\rquote 
s difficult to confirm the setup procedure without doing a full installation.
\par 
\par Some projects may be exact copies, so you can use the backup of that project, but generally you should try to start with the source at <}{\field{\*\fldinst {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 HYPERLINK "\\\\\\\\hqdata\\\\Works006\\\\
pw3 development\\\\Paint.net\\\\Source"}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid6835532 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b0200000003010000330000005c005c006800710064006100740061005c0057006f0072006b0073003000300036005c00700077003300200064006500760065006c006f0070006d0065006e0074005c005000610069006e0074002e006e00650074005c0053006f00750072006300
650000000000}}}{\fldrslt {\rtlch\fcs1 \af0 \ltrch\fcs0 \ul\cf2\insrsid10304090 \\\\hqdata\\Works006\\pw3 development\\Paint.net\\Source}}}\sectd \linex0\sectdefaultcl\sftnbj {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 >
\par 
\par Be sure to copy the appropriate PLCComm.dll, PLCComm.pdb, and PLCComm.xml from \\Source\\PLCComm\\*\\ to \\VBApps\\.
\par Some programs, especially older ones may still link to the PLC form directly.  Either switch them to PLCComm.dll or make sure they link to the correct PLC form and dlls.
\par 
\par Most of the programs will not require customization for a typical project.  The main exceptions are:
\par 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 BSD}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash 
 Hopefully you can find a recent project with a similar booth layout.  The farther back you go to get a BSD, the more difficulties you will run into compiling with the latest common files.  Also old bugs that have been fixed creep back in this way.
\par 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 PLC IO}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash  You\rquote ll need to update resource files in source code and XML files in the database folder.  
\par If you\rquote re using a logix controller, you can export to L5K and run it through the LogixTagconverter program in the view folder.  It\rquote ll read all the IO bloc
ks and output a spreadsheet you can cut and paste into the resource file, an XML config file, and a text file with the logic required to manage the IO status.  There are two versions of the logic.  I\rquote m not sure what\rquote 
s being used everywhere, but the {\*\xmlopen\xmlns2{\factoidname place}}{\*\xmlopen\xmlns2{\factoidname place}}{\*\xmlopen\xmlns2{\factoidname PlaceName}}Tech{\*\xmlclose} {\*\xmlopen\xmlns2{\factoidname place}}Center{\*\xmlclose}{\*\xmlclose}
{\*\xmlclose} uses some new logic to get better alarm messages.  It uses the PLCE alarm category to send a set of alarms for each rack.  The program will probably need updates as the hardware changes.
\par 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 Alarm Manager}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash  Keep the alarm list updated in the resource files.  Also update the messages in Paint\\Help\\AlarmMan\\PLCR.htm and PLCZ.htm
\par 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 Database}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash  There are a few sample databases at <}{\field{\*\fldinst {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 HYPERLINK "\\\\\\\\hqdata\\\\
Works006\\\\pw3 development\\\\Paint.net\\\\Database"}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid6835532 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b0200000003010000350000005c005c006800710064006100740061005c0057006f0072006b0073003000300036005c00700077003300200064006500760065006c006f0070006d0065006e0074005c005000610069006e0074002e006e00650074005c0044006100740061006200
61007300650000000000}}}{\fldrslt {\rtlch\fcs1 \af0 \ltrch\fcs0 \ul\cf2\insrsid10304090 \\\\hqdata\\Works006\\pw3 development\\Paint.net\\Database}}}\sectd \linex0\sectdefaultcl\sftnbj {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 >
\par Most of them have a version number.  Try to use one of the newer versions as the basis for a new project.  They are not exact backups of the project, we try to update the recent versions when the program changes require them.  You may find missing items.

\par T
he top backup folder under the zone name has the SQL files.  Only logs and preset tables are in the SQL format for the latest versions.  Earlier .NET paintworks had most of the configuration in SQL databases, too.  That was slow and difficult to work with
, so most of it\rquote s in XML now.
\par Database subfolders:
\par ECBR \endash  this contains the bootp and tftp servers and configurations for robot image backups.  The network maintenance screen will set these up for you after you have all the robots communicating with the PC.  You may need to create the folders.

\par Notepad \endash  The newest version of the notepad screen saves the notes as RTF files in this folder.  It uses a file in the XML folder to keep them organized.
\par XML \endash  Most of the configuration is in here.
\par DB Types.txt has a few lists of items that are identified by number in the other config files.  The list matches constants in the code.
\par Basic zone setup is in:
\par }\pard \ltrpar\ql \fi-360\li360\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin360\itap0 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 SetupInfo.XML \endash Set the site and default zone name. \line Standalone \endash  True for no PLC.  \line SaveAccessData 
\endash  This is fading away.  It was for the transition from access to SQL.  It would tell new screens to write to the old DBs.
\par \tab MISComputer \endash  True for no robots.
\par ZoneInfo.XML \endash  Set the zone name and number, PLC type, PLC name in the host file, number of styles, colors, valves, and options.  Enable a bunch of other features.
\par CultureInfo.XML \endash  For a foreign language installation, you can change the default or add a new culture.  If you add a culture you\rquote ll need to add resource files for all the programs.  Start with main.  Other p
rograms will use the default files if an unsupported culture is selected, but you need to have at least the flag image and culturetext tag defined in main.
\par StartupList.XML \endash  You shouldn\rquote t normally need to mess with this.  Sealer jobs will have a couple programs paint doesn\rquote t \endash  HotEditLogger and VisionLogger.  Standalone zones won\rquote t need ProdLogger.
\par Controllers.XML \endash  A list of controllers by zone\line Set up controller names and sort order.  InternalBackup enables the backup where the PLC tells the robot to run an autobackup, then paintwork gets it from FRA:.  If internalBackup isn\rquote 
t used, the backup path can be set to MDB: for a normal backup or MD: for a backup with text files.  HotEditLoggerDO is the digital output monitored by the HotEditLogger.  Set it to 0 for paint jobs.
\par Arms.XML \endash  A list of robot arms by zone\line Set the name and PLC tag prefix.\line Set the arm type, Estat type, and color change type based on DB Types.txt.\line 
ArmNumber is the arm number in the controller, RobotNumber and ArmSortOrder apply to the whole zone.\line IsOpener should be pretty clear.  Don\rquote t forget it.\line 
PaintToolAlias is used by the alarm manager to substitute a longer name for the PaintTool name.  It\rquote s needed for zones with more than one rail.
\par PLC Alarm Zones.XML \endash  configure the tags used by the PLC to tell when new alarms are available.
\par PLC Alarm Devices.XML \endash  Configure each alarm device link.  
\par ProdLinks.XML \endash  Set up the PLC tags for the production reports.
\par ProdData.XML \endash  format the data for the production reports.  The configurable version uses DB column names to handle different configurations.
\par PLC IO.XML \endash   The PLC IO screen configuration.  This one is pretty complicated.  Someday we\rquote ll get better instructions in here or make it easier.
\par ParamSetup\'85XML  Normally you won\rquote t need to modify these.  If you add items, you\rquote ll need to add labels into the paramsetup resource files.
\par MenuData.xml \endash  This configures the menus in PWMain.  
\par DMON\'85.CSV \endash  This is where DMON schedule manager saves the defaults.  There are several examples here.  When you get the robots running, save the default items and schedules from the screen \endash  it\rquote 
ll save to the files with controller names at the end.  If you have a configuration that\rquote s not listed in here, copy it to a descriptive name with version and applicator type.
\par ColorChangeType.XML \endash  normally this won\rquote t require customization.  If you add a new applicator type you\rquote ll need to add the type in here, DB types.txt and there\rquote 
ll be a bunch of programming to do.  This will get reinitialized by PW_Main.exe during each startup.
\par ApplicatorParameterTables \endash 
 The color change type selects which table to use from this list.  It accounts for bell vs. gun, single or dual shaping air, cal table requirements.  Command and output ranges are set in here.  This will get reinitialized by PW_Main.
exe during each startup.
\par Browser.XML \endash  This configures the web browser for zone devices with web pages and the help screens.
\par The rest of the tables should be managed by the screens.  You may want to make sure you don\rquote t have extra colors, valves, styles, or options.
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid16659031\charrsid16659031 Network}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031  \endash  Make sure java is installed.  Set up the IP address for the switch if possible.}{\rtlch\fcs1 \af0 \ltrch\fcs0 
\insrsid10304090 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031 All NTRONs use 192.168.1.201 as the default IP address.  User and password are both \'93admin\'94
\par Make sure the browser can reach any devices that support a web page  - SMCs, robots, Rockwell ENBTs, EN2Ts, AENTs.  Set up names in the host file.
\par 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 Robot Image backups}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash  The network maintenance screen will do all the setup for robot image backups if the normal robot communication
 is working.  There\rquote 
s a text box for network setup files on the lower portion of the screen.  The text box will have an autoconfig button available when tftp.cfg and bootp.cfg are displayed.  The hosts file should be handled by your installation procedure. 
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid13729148\charrsid13729148 Help/Online Manuals}{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid13729148  \endash  }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid13729148 You normally shouldn\rquote 
t need to make too many changes.  Check the CDs that ship with the robots to make sure you have up to date manuals on the GUI.   Help uses PDFs, so make sure a reader is installed.}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid13729148\charrsid13729148 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid13729148\charrsid13729148 
\par }{\rtlch\fcs1 \ab\af0 \ltrch\fcs0 \b\insrsid10304090 General debug}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090  \endash  
\par }\pard \ltrpar\ql \fi-360\li360\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin360\itap0\pararsid10304090 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 
VB has an option to enable or disable stopping on exceptions under the debug menu.  Run through everything in VB to see where it\rquote s stopping.  It should be pretty rare that a program uses exceptions for normal operation, so look into an
y time it stops.  \line When you first start you can use a simple utility screen to see if it gets through the databases without errors.  Notepad doesn\rquote t talk to robots or the PLC, so it\rquote 
s good for checking out basic DB errors.  Robot file copy or variables can be used for robot links without dealing with the PLC, the clock program is about as simple as it gets with PLC and robot communication.  After the basics are working, you\rquote 
ll need to run through the BSD, fluid maintenance and config screens to make sure all the PLC links are good.
\par }\pard \ltrpar\ql \fi-360\li360\ri0\nowidctlpar\wrapdefault\faauto\rin0\lin360\itap0 {\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 
\par Event logger \endash  Once it\rquote s running, errors should be logged to the windows event logger.  You can get to it from the right click popup in main \endash  type \'93events\'94.  The start menu search will also find it with \'93events\'94
.  The paintworks error log shows up under the Applications and Services Log.  Check it regularly.  If there\rquote s anything other than startup and shutdown messages, try to make them go away.\line 
I've seen it occasionally start logging paintworks events under the appication log instead of PAINTworks.  Running ResetEventLogs.exe resets the logs.
\par 
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid16659031\charrsid16659031 Rockwell}{\rtlch\fcs1 \af0 \ltrch\fcs0 \b\insrsid16659031  \endash  }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031 Managing network usage:}{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid10304090 

\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031\charrsid16659031 Safety }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031 task defaults to 20ms period.  Change to 30ms for period and watchdog.
\par Change all standard IO to 100ms RPI \endash  AENTs, robot links, analog cards...
\par Set all safety devices t0 15ms Input RPI \endash  the output will automatically be set to the safety task period.
\par Set all IO racks to rack optimization.
\par Set all IO connections to unicast \endash  AENTs, safety IO cards, analog IO card, robots\'85
\par Get all the firmware versions in sync between the hardware and the program.
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid8463552 Any customer except GM \endash  make sure all network devices and switch ports are set to autonegotiate and check the status to make sure they run at 100Mbps/Full duplex
\par GM requires PLC network devices to be set up with autonegotiate off.  This guarantees frustration during the setup.  \line The initial default settings in RSlogix and the network switch will be autonegotiate.  Get it working that way first.  \line 
Once everything is connected, change each AENT.  Disable the autonegotiate set it to 100/Full.  You\rquote 
ll need to reset communication.  When the change is successful it will lose communication and appear to be locked up.  Repeat for each AENT, then the ENBT or EN2T.\line Once all the PLC changes are made in RSLogix, go to th
e Ethernet switch configuration and change each channel connected to the PLC devices.  \line Cycle power on everything, make sure it reconnects at 100/full.  Check the status on the web pages of the devices and the switch and in RSLinx.  
\par 
\par }{\rtlch\fcs1 \af0 \ltrch\fcs0 \insrsid16659031\charrsid16659031 
\par }}